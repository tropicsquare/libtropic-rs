% socat -d -d -v PTY,link=/tmp/virtual_serial,raw,echo=1,icanon=1 OPEN:/dev/cu.usbmodem4982328A384B1,raw
2025/03/18 17:47:32 socat[35225] N PTY is /dev/ttys007
2025/03/18 17:47:32 socat[35225] N opening character device "/dev/cu.usbmodem4982328A384B1" for reading and writing
2025/03/18 17:47:32 socat[35225] N starting data transfer loop with FDs [5,5] and [7,7]





Construct a Get_Info_Req

01 = Get_Info_Req
02 = len is two bytes
01 = request the Chip ID
00 = block index (only required for certificate requests)
2B92 = CRC16 Checksum

> 2025/03/18 17:47:34.000854662  length=14 from=0 to=13
010201002B92x

Response:
01 = Status REQ_OK
FF = Status NO_RESP (the tropic01 seems to answer with as many bytes as the request had)

< 2025/03/18 17:47:34.000855207  length=14 from=0 to=13
01FFFFFFFFFF\r

------------------------------------------------------------------------------------------------------------------------------------

Chip Select = 0

> 2025/03/18 17:47:34.000867225  length=5 from=14 to=18
CS=0

Acknowlege

< 2025/03/18 17:47:34.000867473  length=4 from=14 to=17
OK\r


------------------------------------------------------------------------------------------------------------------------------------


AA = Get_Response

> 2025/03/18 17:47:34.000867544  length=4 from=19 to=22
AAx

Response:
01 = Status REQ_OK

< 2025/03/18 17:47:34.000868522  length=4 from=18 to=21
01\r

------------------------------------------------------------------------------------------------------------------------------------

Write two junk bytes to request the length of the response, which is always two bytes

> 2025/03/18 17:47:34.000882516  length=6 from=23 to=28
FFFFx

0180 = 384 bytes in response, the response frame will be 

< 2025/03/18 17:47:34.000882788  length=6 from=22 to=27
0180\r

------------------------------------------------------------------------------------------------------------------------------------


> 2025/03/18 17:47:34.000892204  length=262 from=29 to=290
FFFFFF00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000x


unsure why the response comes in three chunks, but it decodes to ASCII: DÃ¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã°DTST01(TROPIC01-ESÃ¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Ã¿Â¸Ã£[
it contains DTST01 and TROPIC01

< 2025/03/18 17:47:34.000895983  length=64 from=28 to=91
0000000100000000000000000000000000000000000000000000000000000000
< 2025/03/18 17:47:34.000896044  length=128 from=92 to=219
0000000001000000054400000000FFFFFFFFFFFF01F00F000544545354303103002800080B54524F50494330312D4553FFFFFFFF000100000000FFFF00010000
< 2025/03/18 17:47:34.000896138  length=70 from=220 to=289
0000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB8010300E35B\r


------------------------------------------------------------------------------------------------------------------------------------


> 2025/03/18 17:47:34.000904773  length=5 from=291 to=295
CS=0
< 2025/03/18 17:47:34.000905030  length=4 from=290 to=293
OK\r


------------------------------------------------------------------------------------------------------------------------------------

Requests RISCV_FW_VERSION

> 2025/03/18 17:47:34.000905080  length=14 from=296 to=309
010202002B98x
< 2025/03/18 17:47:34.000906210  length=14 from=294 to=307
01FFFFFFFFFF\r


> 2025/03/18 17:47:34.000916430  length=5 from=310 to=314
CS=0
< 2025/03/18 17:47:34.000916676  length=4 from=308 to=311
OK\r


> 2025/03/18 17:47:34.000916716  length=4 from=315 to=318
AAx
< 2025/03/18 17:47:34.000917743  length=4 from=312 to=315
01\r


> 2025/03/18 17:47:34.000929295  length=6 from=319 to=324
FFFFx
< 2025/03/18 17:47:34.000929980  length=6 from=316 to=321
0104\r


> 2025/03/18 17:47:34.000941851  length=14 from=325 to=338
FFFFFF010000x
< 2025/03/18 17:47:34.000942268  length=14 from=322 to=335
00020100C87F\r

0x00020100 == dec131328, the current firmware seems to be 1.3.1, so maybe it's that

------------------------------------------------------------------------------------------------------------------------------------

------------------------------------------------------------------------------------------------------------------------------------


> 2025/03/18 17:47:34.000954483  length=5 from=339 to=343
CS=0
< 2025/03/18 17:47:34.000955334  length=4 from=336 to=339
OK\r

Request SPECT_FW_VERSION

> 2025/03/18 17:47:34.000955565  length=14 from=344 to=357
010204002B8Cx
< 2025/03/18 17:47:34.000956221  length=14 from=340 to=353
01FFFFFFFFFF\r


> 2025/03/18 17:47:34.000968874  length=5 from=358 to=362
CS=0
< 2025/03/18 17:47:34.000969087  length=4 from=354 to=357
OK\r


> 2025/03/18 17:47:34.000969162  length=4 from=363 to=366
AAx
< 2025/03/18 17:47:34.000970145  length=4 from=358 to=361
01\r


> 2025/03/18 17:47:34.000981676  length=6 from=367 to=372
FFFFx
< 2025/03/18 17:47:34.000981985  length=6 from=362 to=367
0104\r


> 2025/03/18 17:47:34.000994196  length=14 from=373 to=386
FFFFFF00C87Fx
< 2025/03/18 17:47:34.000994602  length=14 from=368 to=381
00010300F7F3\r


The next four frame/response pairs get four chunks of the chip's certificate

> 2025/03/18 17:47:35.000004772  length=5 from=387 to=391
CS=0
< 2025/03/18 17:47:35.000005005  length=4 from=382 to=385
OK\r


> 2025/03/18 17:47:35.000005033  length=14 from=392 to=405
010200002814x
< 2025/03/18 17:47:35.000006240  length=14 from=386 to=399
01FFFFFFFFFF\r


> 2025/03/18 17:47:35.000017578  length=5 from=406 to=410
CS=0
< 2025/03/18 17:47:35.000017867  length=4 from=400 to=403
OK\r


> 2025/03/18 17:47:35.000017901  length=4 from=411 to=414
AAx
< 2025/03/18 17:47:35.000018882  length=4 from=404 to=407
01\r


> 2025/03/18 17:47:35.000030428  length=6 from=415 to=420
FFFFx
< 2025/03/18 17:47:35.000030699  length=6 from=408 to=413
0180\r


> 2025/03/18 17:47:35.000042903  length=262 from=421 to=682
FFFFFF00F7F300000000000000000000000000000000000000000000000000000000000001000000054400000000FFFFFFFFFFFF01F00F000544545354303103002800080B54524F50494330312D4553FFFFFFFF000100000000FFFF000100000000FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFB8010300E35Bx
< 2025/03/18 17:47:35.000046857  length=128 from=414 to=541
010401A9024502720272308201A53082012AA003020102021001F00F00054454535430310300280008300A06082A8648CE3D0403033052310B30090603550406< 2025/03/18 17:47:35.000047050  length=134 from=542 to=675
1302435A311D301B060355040A0C1454726F7069632053717561726520732E722E6F2E3124302206035504030C1B54524F50494330312D582043412076312D569CB8\r


> 2025/03/18 17:47:35.000055439  length=5 from=683 to=687
CS=0
< 2025/03/18 17:47:35.000055674  length=4 from=676 to=679
OK\r


> 2025/03/18 17:47:35.000055734  length=14 from=688 to=701
010200012D94x
< 2025/03/18 17:47:35.000056880  length=14 from=680 to=693
01FFFFFFFFFF\r


> 2025/03/18 17:47:35.000068252  length=5 from=702 to=706
CS=0
< 2025/03/18 17:47:35.000068482  length=4 from=694 to=697
OK\r


> 2025/03/18 17:47:35.000068515  length=4 from=707 to=710
AAx
< 2025/03/18 17:47:35.000069553  length=4 from=698 to=701
01\r


> 2025/03/18 17:47:35.000078794  length=6 from=711 to=716
FFFFx
< 2025/03/18 17:47:35.000079072  length=6 from=702 to=707
0180\r


> 2025/03/18 17:47:35.000091333  length=262 from=717 to=978
FFFFFFA9024502720272308201A53082012AA003020102021001F00F00054454535430310300280008300A06082A8648CE3D0403033052310B300906035504061302435A311D301B060355040A0C1454726F7069632053717561726520732E722E6F2E3124302206035504030C1B54524F50494330312D582043412076312D569CB8x
< 2025/03/18 17:47:35.000095298  length=128 from=708 to=835
414C49444154494F4E301E170D3235303231383134313731305A170D3435303231383134313731305A30223120301E06035504030C1754524F50494330312065< 2025/03/18 17:47:35.000095485  length=134 from=836 to=969
53452D56414C49444154494F4E302A300506032B656E032100E44436C00C62FF2678F20A7E99C2886E9AF58188A3E2F364F4C21834A91A047FA341303F300C061D3B\r


> 2025/03/18 17:47:35.000103885  length=5 from=979 to=983
CS=0
< 2025/03/18 17:47:35.000104123  length=4 from=970 to=973
OK\r


> 2025/03/18 17:47:35.000104192  length=14 from=984 to=997
010200022794x
< 2025/03/18 17:47:35.000105338  length=14 from=974 to=987
01FFFFFFFFFF\r


> 2025/03/18 17:47:35.000116796  length=5 from=998 to=1002
CS=0
< 2025/03/18 17:47:35.000117082  length=4 from=988 to=991
OK\r


> 2025/03/18 17:47:35.000117158  length=4 from=1003 to=1006
AAx
< 2025/03/18 17:47:35.000118131  length=4 from=992 to=995
01\r


> 2025/03/18 17:47:35.000128375  length=6 from=1007 to=1012
FFFFx
< 2025/03/18 17:47:35.000128682  length=6 from=996 to=1001
0180\r


> 2025/03/18 17:47:35.000141427  length=262 from=1013 to=1274
FFFFFF444154494F4E301E170D3235303231383134313731305A170D3435303231383134313731305A30223120301E06035504030C1754524F5049433031206553452D56414C49444154494F4E302A300506032B656E032100E44436C00C62FF2678F20A7E99C2886E9AF58188A3E2F364F4C21834A91A047FA341303F300C061D3Bx
< 2025/03/18 17:47:35.000145304  length=128 from=1002 to=1129
03551D130101FF04023000300E0603551D0F0101FF040403020308301F0603551D23041830168014A07E17C9814A25A12E7608EC2246B2A8F61BBE3E300A0608< 2025/03/18 17:47:35.000145463  length=134 from=1130 to=1263
2A8648CE3D04030303690030660231009CD43CDC1C4550AECEAADFAC7764F2E9B932AAD0636400D7EAD18F5037A46FE6942513FAB93FC139E8F82230C8178AC6335F\r


> 2025/03/18 17:47:35.000154098  length=5 from=1275 to=1279
CS=0
< 2025/03/18 17:47:35.000154401  length=4 from=1264 to=1267
OK\r


> 2025/03/18 17:47:35.000154925  length=14 from=1280 to=1293
010200032214x
< 2025/03/18 17:47:35.000155567  length=14 from=1268 to=1281
01FFFFFFFFFF\r


> 2025/03/18 17:47:35.000166081  length=5 from=1294 to=1298
CS=0
< 2025/03/18 17:47:35.000166384  length=4 from=1282 to=1285
OK\r


> 2025/03/18 17:47:35.000166445  length=4 from=1299 to=1302
AAx
< 2025/03/18 17:47:35.000167389  length=4 from=1286 to=1289
01\r


> 2025/03/18 17:47:35.000177567  length=6 from=1303 to=1308
FFFFx
< 2025/03/18 17:47:35.000177848  length=6 from=1290 to=1295
0180\r


> 2025/03/18 17:47:35.000190152  length=262 from=1309 to=1570
FFFFFF130101FF04023000300E0603551D0F0101FF040403020308301F0603551D23041830168014A07E17C9814A25A12E7608EC2246B2A8F61BBE3E300A06082A8648CE3D04030303690030660231009CD43CDC1C4550AECEAADFAC7764F2E9B932AAD0636400D7EAD18F5037A46FE6942513FAB93FC139E8F82230C8178AC6335Fx
< 2025/03/18 17:47:35.000194048  length=128 from=1296 to=1423
023100D2F9456A810B9217A31B800BF3DD5E9B301E9294F50097052BB4582D005950F1654C57F5BD0CB67BFF3D46EE3779AEDC30820241308201C7A003020102< 2025/03/18 17:47:35.000194199  length=134 from=1424 to=1557
02022711300A06082A8648CE3D040303305A310B300906035504061302435A311D301B060355040A0C1454726F7069632053717561726520732E722E6F2E312C2D2B\r


> 2025/03/18 17:47:35.000202317  length=5 from=1571 to=1575
CS=0
< 2025/03/18 17:47:35.000202532  length=4 from=1558 to=1561
OK\r


Handshake request with the MCU's public ephemeral key

> 2025/03/18 17:47:35.000203206  length=76 from=1576 to=1651
0221CF075A98910BD86ACEEB6A5C979765243D73E7ED6BB3C115A6BEE5DD555C222F00A047x
< 2025/03/18 17:47:35.000204538  length=76 from=1562 to=1637
01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\r


> 2025/03/18 17:47:35.000215145  length=5 from=1652 to=1656
CS=0
< 2025/03/18 17:47:35.000215383  length=4 from=1638 to=1641
OK\r


Ok so what is happening here? The chip is responding with 00 while processing the request, after that it will respond with 01 and we can proceed

> 2025/03/18 17:47:35.000215445  length=4 from=1657 to=1660
AAx
< 2025/03/18 17:47:35.000216427  length=4 from=1642 to=1645
00\r


> 2025/03/18 17:47:35.000226178  length=5 from=1661 to=1665
CS=0
< 2025/03/18 17:47:35.000226437  length=4 from=1646 to=1649
OK\r


> 2025/03/18 17:47:35.000256324  length=4 from=1666 to=1669
AAx
< 2025/03/18 17:47:35.000256638  length=4 from=1650 to=1653
00\r


> 2025/03/18 17:47:35.000268865  length=5 from=1670 to=1674
CS=0
< 2025/03/18 17:47:35.000269060  length=4 from=1654 to=1657
OK\r


> 2025/03/18 17:47:35.000298917  length=4 from=1675 to=1678
AAx
< 2025/03/18 17:47:35.000299215  length=4 from=1658 to=1661
00\r


> 2025/03/18 17:47:35.000309640  length=5 from=1679 to=1683
CS=0
< 2025/03/18 17:47:35.000309894  length=4 from=1662 to=1665
OK\r


> 2025/03/18 17:47:35.000337329  length=4 from=1684 to=1687
AAx
< 2025/03/18 17:47:35.000337621  length=4 from=1666 to=1669
00\r


> 2025/03/18 17:47:35.000350050  length=5 from=1688 to=1692
CS=0
< 2025/03/18 17:47:35.000350275  length=4 from=1670 to=1673
OK\r


> 2025/03/18 17:47:35.000381839  length=4 from=1693 to=1696
AAx
< 2025/03/18 17:47:35.000382099  length=4 from=1674 to=1677
01\r


> 2025/03/18 17:47:35.000394314  length=6 from=1697 to=1702
FFFFx
< 2025/03/18 17:47:35.000394634  length=6 from=1678 to=1683
0130\r


> 2025/03/18 17:47:35.000406947  length=102 from=1703 to=1804
FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000000000000000000000000000x
< 2025/03/18 17:47:35.000408585  length=102 from=1684 to=1785
069A0EC821293B51F11DE08E4195DDCF14F0F558967AF8A8017757B85E178C0573E3E07BAF8CAD433B68A4402C4EE6B75ECE\r


> 2025/03/18 17:47:35.000417823  length=5 from=1805 to=1809
CS=0
< 2025/03/18 17:47:35.000418044  length=4 from=1786 to=1789
OK\r


> 2025/03/18 17:47:35.000421918  length=50 from=1810 to=1859
0414020056A0D4151CB481F644D9532F024A09F26CF7E0A1x
< 2025/03/18 17:47:35.000422806  length=50 from=1790 to=1839
01FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF\r


> 2025/03/18 17:47:35.000434495  length=5 from=1860 to=1864
CS=0
< 2025/03/18 17:47:35.000434724  length=4 from=1840 to=1843
OK\r


> 2025/03/18 17:47:35.000434773  length=4 from=1865 to=1868
AAx
< 2025/03/18 17:47:35.000435787  length=4 from=1844 to=1847
01\r


> 2025/03/18 17:47:35.000447820  length=6 from=1869 to=1874
FFFFx
< 2025/03/18 17:47:35.000448092  length=6 from=1848 to=1853
0100\r


> 2025/03/18 17:47:35.000460134  length=6 from=1875 to=1880
FFFFx
< 2025/03/18 17:47:35.000460406  length=6 from=1854 to=1859
0386\r


> 2025/03/18 17:47:35.000471285  length=5 from=1881 to=1885
CS=0
< 2025/03/18 17:47:35.000471506  length=4 from=1860 to=1863
OK\r


> 2025/03/18 17:47:35.000471596  length=4 from=1886 to=1889
AAx
< 2025/03/18 17:47:35.000472617  length=4 from=1864 to=1867
01\r


> 2025/03/18 17:47:35.000484152  length=6 from=1890 to=1895
0100x
< 2025/03/18 17:47:35.000484398  length=6 from=1868 to=1873
0236\r


> 2025/03/18 17:47:35.000495534  length=114 from=1896 to=2009
0386FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7AF8A8017757B85E178C0573E3E07BAF8CAD433B68A4402C4EE6B75ECE000000000000x
< 2025/03/18 17:47:35.000497403  length=114 from=1874 to=1987
24008CB8036E00A159009DFC44C722F3F210649051F14102F3ED76B72EF96AFE647FF6C027C1A7CD522235700C2BD0C615249C539D703D6F\r


> 2025/03/18 17:47:35.000506962  length=5 from=2010 to=2014
CS=0
< 2025/03/18 17:47:35.000507130  length=4 from=1988 to=1991
OK\r